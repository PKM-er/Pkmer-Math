---
tags:
  - 数学
dlink:
  - "[[---微分方程---]]"
  - "[[常系数线性微分方程]]"
author:
  - Cyletix
finished: false
---
二阶常系数非齐次线性微分方程的一般形式
$$y''+py'+qy=f(x)$$
由[[二阶线性微分方程解的结构#定理3]]可知, 求解二阶常系数非齐次线性微分方程的通解, 归结为求对应齐次方程的通解和非齐次方程本身的一个特解

对应齐次方程的通解在[[常系数齐次线性微分方程]]得到解决, 所以这里只讨论求特解的方法. 

# 待定系数法
这里讨论$f(x)$的两种形式
## 指数解
$$f(x)=e^{ \lambda x }P_{m}(x)$$
由于多项式与指数函数乘积的导数仍是多项式, 可以推测$y^*=R(x)e^{ \lambda x }$为一个特解, 

(推导略)

特解形式为:
$$y^*=x^kR_{m}(x)e^{ \lambda x }$$
其中$R_{m}(x)$是与$P_{m}(x)$同次的多项式, 
$$R_m(x)=b_0x^m+b_1x^{m-1}+\cdots+b_mx^{0}$$
$k\in\{0,1,2\}$根据特征方程根的数量决定,
- 若$\lambda$不是特征方程的根, $k=0$
- 若$\lambda$是特征方程的单根, $k=1$
- 若$\lambda$是特征方程的重根, $k=2$

将特解带回方程, 解得系数 $b_0$, $b_1$, ... $b_m$


>[!example]+
>
$$y'' - 3y' + 2y = e^{2x}$$
> 1. 对应的齐次方程：$y'' - 3y' + 2y = 0$
> 求解特征方程：$r^2 - 3r + 2 = 0$, 得$r = 1, 2$
> 齐次方程的通解：$y_h = C_1 e^x + C_2 e^{2x}$
> 2. 由于非齐次项$f(x) = e^{2x}$，且$\lambda = 2$是特征方程的单根，所以设$k=1$。
>
$$y_p = x b_0 e^{2x}$$
> 3. 代入原方程：
>
$$(4b_0 e^{2x} + 4b_0x e^{2x}) - 3(b_0 e^{2x} + 2b_0x e^{2x}) + 2x b_0 e^{2x} = e^{2x}$$
> 整理并合并同类项：$b_0 e^{2x} = e^{2x}$ , 解得$b_0 = 1$。
> 4. 构造非齐次的通解：
>
$$y = C_1 e^x + C_2 e^{2x} + x e^{2x}$$


---
## 圆函数解
$$f(x)=e^{ \lambda x }[P_{l}(x)\cos(\omega x)+Q_{n}(x)\sin(\omega x)]$$

应用欧拉公式变为复指数求解, 推导略

特解形式为:
$$y^*=x^{k}e^{ \lambda x }[R_{m}^{(1)}(x)\cos(\omega x)+R_{m}^{(2)}(x)\sin(\omega x)]$$
$R_{m}^{(1)}(x)$, $R_{m}^{(2)}(x)$ 是m次多项式, 

$m=max(l,n)$, 

$k$是特征方程中 $\lambda+\omega i$或$\lambda-\omega i$ 这两个根的重复次数(二阶只能取到$\{0,1\}$)


 >[!example]+
> 考虑方程：
>
$$y'' + py' + qy = \cos(\omega x)$$
> 这是含圆函数的简单形式，其中$P_l(x)$和$Q_n(x)$均为0次多项式。
> 
> 1. **应用欧拉公式**：
>    使用欧拉公式将$\cos(\omega x)$表达为复指数的实部：
>
$$\cos(\omega x) = \frac{e^{i\omega x} + e^{-i\omega x}}{2}$$
> 
> 2. **假设特解形式**：
>    假设特解的形式为：
>
$$y^* = x^k [A \cos(\omega x) + B \sin(\omega x)]$$
>    其中，$k$是特征方程中$i\omega$或$-i\omega$这两个根的重复次数。
> 
> 3. **代入原方程求解**：
>    将假设的特解形式代入原方程，并求解未知系数$A$和$B$。


---
# 推广
- [[#n阶常系数非齐次线性微分方程]]
- [[#复系数非齐次线性微分方程]]
- [[#非齐次线性偏微分方程]]

## n阶常系数非齐次线性微分方程
上述方法可以完全推广至n阶

## 复系数非齐次线性微分方程
待定系数法可以推广至复系数。推广时，复数形式的特解会包含实部和虚部。因此，方法的本质不会改变，只是处理的系数和解的形式需要考虑复数的实部和虚部。

考虑一个带有复系数的非齐次线性微分方程：
$$ a_n y^{(n)} + a_{n-1} y^{(n-1)} + \cdots + a_1 y' + a_0 y = f(x) $$
### 情况1：$f(x) = e^{\lambda x}P_m(x)$
特解的形式为：
$$ y^* = x^k R_m(x) e^{\lambda x} $$
如果$\lambda$为复数，例如$\lambda = \alpha + i \beta$，那么特解形式依旧成立，只是需要考虑$\lambda$的复数部分。因此，
$$ y^* = x^k R_m(x) e^{(\alpha + i \beta)x} = x^k R_m(x) e^{\alpha x} (\cos(\beta x) + i \sin(\beta x)) $$
### 情况2：$f(x) = e^{\lambda x} \left[P_l(x) \cos(\omega x) + Q_n(x) \sin(\omega x)\right]$
特解的形式为：
$$ y^* = x^k e^{\lambda x} \left[R_m^{(1)}(x) \cos(\omega x) + R_m^{(2)}(x) \sin(\omega x)\right] $$
同理，若$\lambda = \alpha + i \beta$，特解可以写为：
$$ y^* = x^k e^{(\alpha + i \beta)x} \left[R_m^{(1)}(x) \cos(\omega x) + R_m^{(2)}(x) \sin(\omega x)\right] $$
$$ y^* = x^k e^{\alpha x} (\cos(\beta x) + i \sin(\beta x)) \left[R_m^{(1)}(x) \cos(\omega x) + R_m^{(2)}(x) \sin(\omega x)\right] $$
### 总结
待定系数法对于复系数的推广，特解形式仍然保持一致，只是需要在计算时处理复数的实部和虚部。具体步骤包括：
1. 确定特解形式，保持与实数系数情况一致。
2. 计算特解时，处理复数指数函数时的实部和虚部。
3. 最终解通常会包含实部和虚部的组合。

通过这种方法，待定系数法可以顺利推广到复系数的情形。

## 非齐次线性偏微分方程
对于非齐次线性偏微分方程，待定系数法的推广会更复杂，但基本思想仍然适用。具体来说，我们需要处理多变量的情况，并且要考虑偏微分算子的特性。

假设我们有一个非齐次线性偏微分方程：

$$
L[u] = f(x, y)
$$

其中$L$是一个线性偏微分算子，$u = u(x, y)$是未知函数，$f(x, y)$是已知的非齐次项。

### 情况1：$f(x, y) = e^{\lambda x + \mu y} P_m(x, y)$

对于这样的非齐次项，我们假设特解的形式为：

$$
u^* = x^k y^l R_m(x, y) e^{\lambda x + \mu y}
$$

其中，$R_m(x, y)$是$x$和$y$的多项式，$k$和$l$是确定特解的常数。

### 情况2：$f(x, y) = e^{\lambda x + \mu y} \left[ P_l(x, y) \cos(\omega x + \nu y) + Q_n(x, y) \sin(\omega x + \nu y) \right]$

对于这样的非齐次项，我们假设特解的形式为：

$$
u^* = x^k y^l e^{\lambda x + \mu y} \left[ R_l^{(1)}(x, y) \cos(\omega x + \nu y) + R_l^{(2)}(x, y) \sin(\omega x + \nu y) \right]
$$

### 具体步骤

1. **假设特解的形式**：根据非齐次项$f(x, y)$的形式，假设特解$u^*$的形式。形式中包含指数函数、多项式和三角函数的组合。

2. **代入方程**：将假设的特解代入原偏微分方程$L[u] = f(x, y)$。

3. **确定待定系数**：通过比较方程两边的系数，确定假设特解中的未知常数$k$, $l$和多项式$R_m(x, y)$或$R_l^{(1)}(x, y)$、$R_l^{(2)}(x, y)$的系数。

### 示例

考虑以下偏微分方程：

$$
\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} = e^{\lambda x + \mu y}
$$

我们假设特解的形式为：

$$
u^* = e^{\lambda x + \mu y}
$$

代入偏微分方程：

$$
\frac{\partial^2}{\partial x^2} \left( e^{\lambda x + \mu y} \right) + \frac{\partial^2}{\partial y^2} \left( e^{\lambda x + \mu y} \right) = \lambda^2 e^{\lambda x + \mu y} + \mu^2 e^{\lambda x + \mu y}
$$

显然，$\lambda^2 + \mu^2 = 1$。

对于更复杂的非齐次项，比如$e^{\lambda x + \mu y} \left[ P_l(x, y) \cos(\omega x + \nu y) + Q_n(x, y) \sin(\omega x + \nu y) \right]$，特解的假设形式和处理方法类似于常系数非齐次线性微分方程，只是要处理多变量和偏微分运算。

### 总结

待定系数法推广到非齐次线性偏微分方程时，需要考虑多变量的情况和偏微分算子的特性。基本步骤与常微分方程类似，但在处理具体解时会更复杂，需要考虑多项式和指数函数的组合及其在多变量下的表现形式。


实际情况中非齐次项$f(x,y)$不会太复杂, 可以观察$f(x,y)$形式直接写
1. 观察是指数型还是圆函数型
2. 观察多项式能否分离变量, 若可以分离, 则直接设$y^*=g(x)h(y)$ 
